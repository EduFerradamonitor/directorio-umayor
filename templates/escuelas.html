<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Directorio de Escuelas | UM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        body{
            margin:0;
            font-family: Arial, Helvetica, sans-serif;
            background:#f5f7fa;
            color:#222;
        }

        /* Barra superior */
        .top{
            background:#ffffff;
            padding:12px 20px;
            display:flex;
            align-items:center;
            gap:15px;
            border-bottom:4px solid #f2b705;
        }

        .top a{
            text-decoration:none;
            color:#005aa9;
            font-weight:600;
            font-size:14px;
        }

        .logo{
            margin-left:auto;
        }

        .logo img{
            height:48px;
        }

        /* Contenedor */
        .container{
            max-width:1100px;
            margin:30px auto;
            padding:0 20px;
        }

        h1{
            font-size:26px;
            margin-bottom:20px;
        }

        /* Buscador */
        .search{
            display:flex;
            gap:10px;
            flex-wrap:wrap;
            margin-bottom:20px;
        }

        .search input,
        .search select{
            padding:10px;
            font-size:15px;
            width:60%;
            max-width:420px;
        }

        .search select{
            width:auto;
        }

        .search button{
            padding:10px 18px;
            background:#005aa9;
            color:#fff;
            border:none;
            cursor:pointer;
            font-weight:600;
        }

        .search button.secondary{
            background:#888;
        }

        /* Tabla */
        table{
            width:100%;
            border-collapse:collapse;
            background:#fff;
        }

        th, td{
            border:1px solid #ddd;
            padding:10px;
            vertical-align:top;
            font-size:14px;
        }

        th{
            background:#005aa9;
            color:#fff;
            text-align:left;
        }

        /* Tooltip */
        .info{
            cursor:help;
            color:#005aa9;
            font-weight:bold;
        }

        /* Footer */
        footer{
            text-align:center;
            font-size:13px;
            color:#666;
            margin:40px 0 20px;
        }
    </style>
</head>

<body>

<!-- Barra superior -->
<div class="top">
    <a href="/">‚¨ÖÔ∏è Volver al inicio</a>

    <div class="logo">
        <img src="{{ url_for('static', filename='img/logoum.jpg') }}" alt="UM">
    </div>
</div>

<div class="container">
    <h1>üìò Directorio de Escuelas</h1>

    <div class="search">
        <input id="q" placeholder="Buscar escuela, nombre o cargo"
               onkeydown="if(event.key==='Enter') buscar();">

        <select id="sede">
            <option value="">Todas las sedes</option>
            <option value="santiago">Santiago</option>
            <option value="temuco">Temuco</option>
        </select>

        <button onclick="buscar()">Buscar</button>
        <button class="secondary" onclick="limpiar()">Limpiar</button>
    </div>

    <div id="resultado"></div>
</div>

<footer>
    Desarrollado por <strong>Eduardo Ferrada</strong><br>
    Universidad Mayor ¬∑ Enero 2026
</footer>

<script>
function buscar(){
    const q = document.getElementById("q").value;
    const sede = document.getElementById("sede").value;
    const res = document.getElementById("resultado");

    fetch(`/api/escuelas?q=${encodeURIComponent(q)}&sede=${encodeURIComponent(sede)}`)
    .then(r => r.json())
    .then(d => {
        if(!d.length){
            res.innerHTML = "<p>Sin resultados.</p>";
            return;
        }

        let html = `
        <table>
            <tr>
                <th>Director</th>
                <th>Cargo</th>
                <th>Correo Director</th>
                <th>Secretar√≠a</th>
                <th>Correo Secretar√≠a</th>
            </tr>`;

        d.forEach(r => {
            html += `
            <tr>
                <td>${r.nombre || ""}</td>
                <td>${r.cargo || ""}</td>
                <td>${r.correo_director ? `<a href="mailto:${r.correo_director}">${r.correo_director}</a>` : ""}</td>
                <td>${r.secretaria || ""}</td>
                <td>${r.correo_secretaria ? `<a href="mailto:${r.correo_secretaria}">${r.correo_secretaria}</a>` : ""}</td>
            </tr>`;
        });

        html += "</table>";
        res.innerHTML = html;
    })
    .catch(()=>{
        res.innerHTML = "<p>Error al consultar la informaci√≥n.</p>";
    });
}

function limpiar(){
    document.getElementById("q").value="";
    document.getElementById("sede").value="";
    document.getElementById("resultado").innerHTML="";
}
</script>

</body>
</html>
