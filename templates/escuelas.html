<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Directorio de Escuelas – Universidad Mayor</title>

<style>
body{
  font-family: Calibri, Arial, sans-serif;
  background:#f3f6f9;
  margin:0;
}

/* HEADER */
.header{
  background:#f2b705;
  padding:20px 30px;
  display:flex;
  align-items:center;
  gap:25px;
}
.header img{ height:90px; }
.header h1{
  margin:0;
  font-size:28px;
  color:#002f6c;
}

/* CONTENEDOR */
.container{
  max-width:1200px;
  margin:30px auto;
  background:#fff;
  padding:30px;
  border-radius:12px;
  box-shadow:0 0 20px rgba(0,0,0,.1);
}

/* BUSCADOR */
.search-wrapper{ position:relative; }

.search-bar{
  display:flex;
  gap:10px;
  align-items:center;
}

.search-bar input{
  padding:12px;
  font-size:16px;
  flex:1;
}

.search-bar button,
.search-bar a{
  padding:12px 18px;
  font-size:15px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  text-decoration:none;
}

.btn-primary{ background:#005baa; color:#fff; }
.btn-secondary{ background:#999; color:#fff; }
.btn-home{ background:#005baa; color:#fff; }

.info-help{
  background:#e9eef4;
  color:#005baa;
  border-radius:50%;
  width:34px;
  height:34px;
  font-weight:bold;
  border:none;
  cursor:pointer;
}

/* SUGERENCIAS */
.suggestions{
  position:absolute;
  top:100%;
  left:0;
  right:0;
  background:#fff;
  border:1px solid #ccc;
  border-radius:6px;
  box-shadow:0 6px 14px rgba(0,0,0,.12);
  display:none;
  z-index:50;
}

.suggestion-item{
  padding:10px 14px;
  cursor:pointer;
  font-size:14px;
}
.suggestion-item:hover{ background:#f0f4f8; }

/* TABLA */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:20px;
}
th, td{
  border:1px solid #ddd;
  padding:10px;
  font-size:14px;
}
th{
  background:#005baa;
  color:#fff;
  text-align:left;
}

/* MODALES */
.modal{
  display:none;
  position:fixed;
  z-index:200;
  left:0;
  top:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,.45);
}

.modal-content{
  background:#fff;
  margin:8% auto;
  padding:25px;
  width:520px;
  border-radius:10px;
}

.modal-content h3{
  margin-top:0;
  color:#005baa;
}

.modal-close{
  text-align:right;
}

.modal-close button{
  background:#999;
  color:#fff;
  border:none;
  padding:8px 14px;
  border-radius:6px;
  cursor:pointer;
}

/* FOOTER */
.footer{
  margin-top:40px;
  text-align:center;
  font-size:13px;
  color:#666;
}
</style>
</head>

<body>

<div class="header">
  <a href="https://www.umayor.cl" target="_blank">
    <img src="{{ url_for('static', filename='img/logoum.jpg') }}">
  </a>
  <h1>Directorio de Escuelas</h1>
</div>

<div class="container">

  <div class="search-wrapper">
    <div class="search-bar">
      <input type="text" id="q" placeholder="Buscar escuela o carrera (ej: ingeniería, enfermería, civil…)">
      <button class="btn-primary" onclick="buscar()">Buscar</button>
      <button class="btn-secondary" onclick="limpiar()">Limpiar</button>
      <button class="info-help" onclick="abrirAyuda()">ℹ️</button>
      <a href="/" class="btn-home">Volver</a>
    </div>

    <div id="suggestions" class="suggestions"></div>
  </div>

  <div id="resultados"></div>

</div>

<div class="footer">
  Desarrollado por <strong>Eduardo Ferrada</strong> · Universidad Mayor · 2026
</div>

<!-- MODAL AYUDA -->
<div id="modalAyuda" class="modal">
  <div class="modal-content">
    <h3>¿Cómo usar el buscador?</h3>
    <ul>
      <li>Escribe palabras generales como <strong>ingeniería</strong> para ver todas.</li>
      <li>Si escribes algo más específico como <strong>ingeniería civil</strong>, verás esa opción.</li>
      <li>Puedes usar abreviaciones como <strong>inge</strong>, <strong>enfer</strong>, <strong>odonto</strong>.</li>
      <li>A medida que escribes, la lista se reduce automáticamente.</li>
    </ul>
    <div class="modal-close">
      <button onclick="cerrarAyuda()">Cerrar</button>
    </div>
  </div>
</div>

<script>
// ===== LISTA DE ESCUELAS + ALIASES =====
const escuelas = [
  { nombre:"Ingeniería Civil", aliases:["ingenieria civil","inge civil","civil"] },
  { nombre:"Ingeniería Civil Industrial", aliases:["industrial","inge industrial"] },
  { nombre:"Ingeniería en Computación e Informática", aliases:["computacion","informatica","ti","sistemas"] },
  { nombre:"Ingeniería en Inteligencia Artificial", aliases:["inteligencia artificial","ia","artificial"] },
  { nombre:"Ingeniería en Ciberseguridad", aliases:["ciberseguridad","ciber","seguridad"] },
  { nombre:"Ingeniería Comercial", aliases:["comercial","negocios"] },
  { nombre:"Ingeniería en Administración de Empresas", aliases:["administracion","adm empresas"] },

  { nombre:"Medicina", aliases:["medicina","med"] },
  { nombre:"Enfermería", aliases:["enfermeria","enfer"] },
  { nombre:"Kinesiología", aliases:["kinesiologia","kine"] },
  { nombre:"Fonoaudiología", aliases:["fonoaudiologia","fono"] },
  { nombre:"Odontología", aliases:["odontologia","odonto","dental"] },
  { nombre:"Nutrición y Dietética", aliases:["nutricion","dietista"] },

  { nombre:"Derecho", aliases:["derecho","leyes"] },
  { nombre:"Psicología", aliases:["psicologia","psico"] },
  { nombre:"Periodismo", aliases:["periodismo","comunicacion"] },

  { nombre:"Arquitectura", aliases:["arquitectura","arqui"] },
  { nombre:"Diseño", aliases:["diseno","grafico"] },
  { nombre:"Teatro", aliases:["teatro","artes"] }
];

const input = document.getElementById("q");
const suggestionsBox = document.getElementById("suggestions");

input.addEventListener("input", ()=>{
  const val = input.value.toLowerCase();
  suggestionsBox.innerHTML = "";

  if(val.length < 2){
    suggestionsBox.style.display="none";
    return;
  }

  const matches = escuelas.filter(e =>
    e.nombre.toLowerCase().includes(val) ||
    e.aliases.some(a => a.includes(val))
  );

  if(!matches.length){
    suggestionsBox.style.display="none";
    return;
  }

  matches.forEach(e=>{
    const div=document.createElement("div");
    div.className="suggestion-item";
    div.textContent=e.nombre;
    div.onclick=()=>{
      input.value=e.nombre;
      suggestionsBox.style.display="none";
      buscar();
    };
    suggestionsBox.appendChild(div);
  });

  suggestionsBox.style.display="block";
});

input.addEventListener("keydown",e=>{
  if(e.key==="Enter") buscar();
});

function buscar(){
  const q=input.value;
  fetch(`/api/escuelas?q=${encodeURIComponent(q)}`)
    .then(r=>r.json())
    .then(data=>{
      const res=document.getElementById("resultados");
      if(!data.length){
        res.innerHTML="<p>No se encontraron resultados.</p>";
        return;
      }

      let html="<table><tr><th>Escuela / Carrera</th><th>Campus</th><th>Correo</th></tr>";
      data.forEach(r=>{
        html+=`<tr>
          <td>${r.nombre || ""}</td>
          <td>${r.campus || ""}</td>
          <td><a href="mailto:${r.correo}">${r.correo || ""}</a></td>
        </tr>`;
      });
      html+="</table>";
      res.innerHTML=html;
    });
}

function limpiar(){
  input.value="";
  document.getElementById("resultados").innerHTML="";
  suggestionsBox.style.display="none";
}

function abrirAyuda(){
  document.getElementById("modalAyuda").style.display="block";
}
function cerrarAyuda(){
  document.getElementById("modalAyuda").style.display="none";
}
</script>

</body>
</html>

